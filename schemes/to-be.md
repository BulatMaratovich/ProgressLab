sequenceDiagram
participant R as "Руководитель"
participant S as "Студенты"
participant AG as "LLM-агент контроля"
participant BOT as "TelegramBot"
participant GH as "GitHub API"
participant DB as "Хранилище задач (Notion/Jira)"

AG->>GH: Ежедневный сбор активности команд
note right of AG: Вход: репозитории проектов<br>Выход: метрики коммитов и PR<br>Системы: GitHub API<br>Метрика: частота обновлений<br>Логика: автоматический мониторинг без участия руководителя
AG->>AG: Анализ рисков и периодов тишины
note right of AG: Вход: история активности<br>Выход: флаги риска (low/medium/high)<br>Системы: ML/правила<br>Метрика: точность выявления риска

AG->>BOT: Автоматический запрос статуса |если риск medium/high|
note right of AG: Вход: флаг риска<br>Выход: шаблонный пинг студентам<br>Системы: Telegram Bot API<br>Метрика: скорость реакции студентов
BOT->>S: Пинг о прогрессе
note right of BOT: Вход: автосообщение<br>Выход: запрос статуса<br>Системы: Telegram Bot<br>Метрика: факт ответа

S->>BOT: Ответ о статусе (в свободной форме)
note right of S: Вход: пинг бота<br>Выход: текстовый ответ<br>Системы: Telegram<br>Метрика: наличие ответа

BOT->>AG: Передача текста ответа
note right of BOT: Вход: ответ студента<br>Выход: пересылка в LLM<br>Метрика: скорость обработки
AG->>AG: Классификация ответа и извлечение задач
note right of AG: Вход: свободный текст<br>Выход: структурированный статус, проблемы, задачи<br>Системы: LLM<br>Метрика: качество извлечения задач

AG->>DB: Автообновление задач в Notion/Jira
note right of AG: Вход: структурированные задачи<br>Выход: актуализированный бэклог<br>Метрика: актуальность данных

AG->>R: Еженедельный отчёт о прогрессе
note right of AG: Вход: GitHub+статусы+задачи<br>Выход: сводный отчёт<br>Системы: Telegram/Email<br>Метрика: полнота отчёта

R->>R: Принятие решения о консультации
note right of R: Вход: отчёт<br>Выход: решение о встрече<br>Метрика: минимизация ручного анализа

R->>BOT: Команда назначить консультацию
note right of R: Вход: решение<br>Выход: команда боту<br>Метрика: скорость назначения встречи
BOT->>S: Автоприглашение на консультацию
note right of BOT: Вход: команда<br>Выход: слоты встречи<br>Метрика: подтверждение студентом

R->>S: Проведение консультации
note right of R: Вход: отчёт+вопросы<br>Выход: договорённости и новые задачи<br>Метрика: продуктивность встречи

R->>AG: Отправка голосового/текстового резюме встречи
note right of R: Вход: резюме<br>Выход: текст/аудио для обработки<br>Метрика: скорость фиксации итогов
AG->>AG: Автопротоколирование встречи
note right of AG: Вход: резюме<br>Выход: протокол, список задач<br>Системы: LLM<br>Метрика: точность структурирования

AG->>DB: Обновление задач после встречи
note right of AG: Вход: протокол<br>Выход: новые задачи и статусы<br>Метрика: актуальность данных

AG->>GH: Проверка выполнения задач по активности
note right of AG: Вход: коммиты<br>Выход: обновление статуса задач<br>Метрика: корректность синхронизации
AG->>AG: Переоценка риска (циклично)
note right of AG: Вход: новые данные<br>Выход: обновлённый риск<br>Метрика: чувствительность модели

AG->>R: Эскалация |если критический риск|
note right of AG: Вход: высокий риск<br>Выход: сигнал руководителю<br>Метрика: своевременность эскалации
